{"title":"hexo 部署到腾讯云","slug":"hexo-部署到腾讯云","date":"2021-04-14T08:14:24.000Z","updated":"2024-09-28T10:07:10.000Z","comments":true,"path":"api/articles/hexo-部署到腾讯云.json","realPath":null,"excerpt":null,"covers":null,"cover":null,"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><blockquote>\n<p>目前就是部署完了，就等备案通过了。</p>\n</blockquote>\n<h2>一、部署环境与准备</h2>\n\n<h3> 1.环境</h3>\n\n<p>本地：Windows10操作系统</p>\n<p>腾讯云：Cenots7.6服务器</p>\n<h3>2.准备</h3>\n\n<p>Hexo 本地博客</p>\n<p>Xshell 链接到你的服务器</p>\n<h2>二、云服务器配置Git</h2>\n\n<h3>1.安装依赖库</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel </span><br></pre></td></tr></table></figure>\n\n<h3>2.安装编译工具</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install gcc perl-ExtUtils-MakeMaker package</span><br></pre></td></tr></table></figure>\n\n<h3>3.查看git的版本</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git version</span><br></pre></td></tr></table></figure>\n\n<h3>4.删除git</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove git -y</span><br></pre></td></tr></table></figure>\n\n<h3>5.下载解压最新版</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /usr/local/src    #下载的目录</span><br><span class=\"line\">wget https://www.kernel.org/pub/software/scm/git/git-2.31.1.tar.gz    #下载最新版，可以去https://www.kernel.org/pub/software/scm/git/查看最新版本号，后面进行相应修改</span><br><span class=\"line\">tar -zxvf git-2.31.1.tar.gz        #解压到当前文件夹</span><br></pre></td></tr></table></figure>\n\n<h3>6.编辑并安装</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd git-2.31.1    #进入文件夹</span><br><span class=\"line\">make prefix=/usr/local/git all    #编译源码</span><br><span class=\"line\">make prefix=/usr/local/git install    #安装路径</span><br></pre></td></tr></table></figure>\n\n<h3>7.配置git的环境变量</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &#x27;export PATH=$PATH:/usr/local/git/bin&#x27; &gt;&gt; /etc/bashrc</span><br></pre></td></tr></table></figure>\n\n<h3>8.刷新环境变量</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source /etc/bashrc</span><br></pre></td></tr></table></figure>\n\n<h3>9.查看版本号</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git --version</span><br></pre></td></tr></table></figure>\n\n<h3>10.创建git用户并且修改权限</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser BTMuli #这里的&quot;BTMuli&quot;是用户名</span><br><span class=\"line\">passwd BTMuli #这里的&quot;BTMuli&quot;是用户名</span><br><span class=\"line\">chmod 740 /etc/sudoers</span><br><span class=\"line\">vim /etc/sudoers</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;i&quot;</span>进入编辑模式，修改为如下代码：</span></span><br><span class=\"line\">root    ALL=(ALL)       ALL</span><br><span class=\"line\">BTMuli  ALL=(ALL)       ALL</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;Esc&quot;</span>退出编辑，按<span class=\"string\">&quot;:wq&quot;</span>保存</span></span><br></pre></td></tr></table></figure>\n\n<h3>11.本地windows10使用Gitbash创建密钥</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>\n\n<h3>12.将本地创建id_rsa.pub中文件复制</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su BTMuli</span><br><span class=\"line\">mkdir ~/.ssh</span><br><span class=\"line\">vim ~/.ssh/authorized_keys</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;i&quot;</span>进入编辑模式，把sshkey粘贴进来</span></span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;Esc&quot;</span>退出编辑，按<span class=\"string\">&quot;:wq&quot;</span>保存</span></span><br></pre></td></tr></table></figure>\n\n<h3>13.本地测试</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -v BTMuli@服务器ip</span><br></pre></td></tr></table></figure>\n\n<h2>三、云服务器网站配置</h2>\n\n<h3>1.创建网站目录并且设置权限</h3>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su root</span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> /home/MyBlog</span><br><span class=\"line\"><span class=\"built_in\">chown</span> BTMuli:BTMuli -R /home/MyBlog</span><br></pre></td></tr></table></figure>\n\n<h3>2.安装Nginx</h3>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y nginx</span><br><span class=\"line\">systemctl start nginx.service    <span class=\"comment\">#启动服务</span></span><br></pre></td></tr></table></figure>\n\n<h3>3.修改Nginx配置文件</h3>\n\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">vim</span> /etc/nginx/nginx.conf </span><br><span class=\"line\"><span class=\"comment\"># 按&quot;i&quot;进入编辑模式，修改为如下代码：</span></span><br><span class=\"line\"> <span class=\"number\">38</span>     server &#123;</span><br><span class=\"line\"> 39         <span class=\"attribute\">listen</span>       <span class=\"number\">80</span> default_server;</span><br><span class=\"line\"> 40         <span class=\"attribute\">listen</span>       [::]:<span class=\"number\">80</span> default_server;</span><br><span class=\"line\"> 41         <span class=\"attribute\">server_name</span>  btmuli.site;        <span class=\"comment\">#域名</span></span><br><span class=\"line\"> 42         <span class=\"attribute\">root</span>         /home/MyBlog;        <span class=\"comment\">#网站目录</span></span><br></pre></td></tr></table></figure>\n\n<h3>4.重启服务器</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx.service</span><br></pre></td></tr></table></figure>\n\n<h3>5.建立git仓库</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su root</span><br><span class=\"line\">cd /home/BTMuli</span><br><span class=\"line\">git init --bare blog.git</span><br><span class=\"line\">chown BTMuli:BTMuli -R blog.git</span><br></pre></td></tr></table></figure>\n\n<h3>6.同步网站根目录</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim blog.git/hooks/post-receive</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;i&quot;</span>进入编辑模式，把sshkey粘贴进来</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"language-bash\">!/bin/sh</span></span><br><span class=\"line\">git --work-tree=/home/MyBlog --git-dir=/home/BTMuli/blog.git checkout -f</span><br></pre></td></tr></table></figure>\n\n<h3>7.修改权限</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /home/BTMuli/blog.git/hooks/post-receive</span><br></pre></td></tr></table></figure>\n\n<h3>8.在windows10本地hexo目录修改_config.yml文件</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repository: </span><br><span class=\"line\">  \t- https://github.com/BTMuli/BTMuli.github.io</span><br><span class=\"line\">  \t- BTMuli@81.71.129.119:/home/BTMuli/blog.git    #用户名@服务器Ip:git仓库位置</span><br><span class=\"line\">  branch: main</span><br></pre></td></tr></table></figure>\n\n<h3>9.在本机gitbash部署</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g -d</span><br></pre></td></tr></table></figure>\n\n<h2>四、常见报错</h2>\n\n<h3>1. <code>git-upload-pack</code>: 未找到命令</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash: git-upload-pack: command not found</span><br><span class=\"line\">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ln -s  /usr/local/git/bin/git-upload-pack  /usr/bin/git-upload-pack</span><br></pre></td></tr></table></figure>\n\n<h3> 2.<code>git-receive-pack</code>: 未找到命令</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash: git-receive-pack: command not found</span><br><span class=\"line\">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ln -s /usr/local/git/bin/git-receive-pack  /usr/bin/git-receive-pack</span><br></pre></td></tr></table></figure>\n\n<h3>3.无法远程连接获取</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">重试或者 删掉本地ssh公钥重新上传至服务器</span><br></pre></td></tr></table></figure>\n\n<h3>4.key出错</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Host key verification failed.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -R 你要访问的IP地址</span><br></pre></td></tr></table></figure>\n\n<p>参考文章：</p>\n<ul>\n<li><a href=\"http://fuchenchenle.cn/2020/08/18/hexo%E9%83%A8%E7%BD%B2%E8%85%BE%E8%AE%AF%E4%BA%91/\">Hexo部署到腾讯云</a></li>\n</ul>\n","more":"<blockquote>\n<p>目前就是部署完了，就等备案通过了。</p>\n</blockquote>\n<h2>一、部署环境与准备</h2>\n\n<h3> 1.环境</h3>\n\n<p>本地：Windows10操作系统</p>\n<p>腾讯云：Cenots7.6服务器</p>\n<h3>2.准备</h3>\n\n<p>Hexo 本地博客</p>\n<p>Xshell 链接到你的服务器</p>\n<h2>二、云服务器配置Git</h2>\n\n<h3>1.安装依赖库</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel </span><br></pre></td></tr></table></figure>\n\n<h3>2.安装编译工具</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install gcc perl-ExtUtils-MakeMaker package</span><br></pre></td></tr></table></figure>\n\n<h3>3.查看git的版本</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git version</span><br></pre></td></tr></table></figure>\n\n<h3>4.删除git</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove git -y</span><br></pre></td></tr></table></figure>\n\n<h3>5.下载解压最新版</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /usr/local/src    #下载的目录</span><br><span class=\"line\">wget https://www.kernel.org/pub/software/scm/git/git-2.31.1.tar.gz    #下载最新版，可以去https://www.kernel.org/pub/software/scm/git/查看最新版本号，后面进行相应修改</span><br><span class=\"line\">tar -zxvf git-2.31.1.tar.gz        #解压到当前文件夹</span><br></pre></td></tr></table></figure>\n\n<h3>6.编辑并安装</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd git-2.31.1    #进入文件夹</span><br><span class=\"line\">make prefix=/usr/local/git all    #编译源码</span><br><span class=\"line\">make prefix=/usr/local/git install    #安装路径</span><br></pre></td></tr></table></figure>\n\n<h3>7.配置git的环境变量</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &#x27;export PATH=$PATH:/usr/local/git/bin&#x27; &gt;&gt; /etc/bashrc</span><br></pre></td></tr></table></figure>\n\n<h3>8.刷新环境变量</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source /etc/bashrc</span><br></pre></td></tr></table></figure>\n\n<h3>9.查看版本号</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git --version</span><br></pre></td></tr></table></figure>\n\n<h3>10.创建git用户并且修改权限</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser BTMuli #这里的&quot;BTMuli&quot;是用户名</span><br><span class=\"line\">passwd BTMuli #这里的&quot;BTMuli&quot;是用户名</span><br><span class=\"line\">chmod 740 /etc/sudoers</span><br><span class=\"line\">vim /etc/sudoers</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;i&quot;</span>进入编辑模式，修改为如下代码：</span></span><br><span class=\"line\">root    ALL=(ALL)       ALL</span><br><span class=\"line\">BTMuli  ALL=(ALL)       ALL</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;Esc&quot;</span>退出编辑，按<span class=\"string\">&quot;:wq&quot;</span>保存</span></span><br></pre></td></tr></table></figure>\n\n<h3>11.本地windows10使用Gitbash创建密钥</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>\n\n<h3>12.将本地创建id_rsa.pub中文件复制</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su BTMuli</span><br><span class=\"line\">mkdir ~/.ssh</span><br><span class=\"line\">vim ~/.ssh/authorized_keys</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;i&quot;</span>进入编辑模式，把sshkey粘贴进来</span></span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;Esc&quot;</span>退出编辑，按<span class=\"string\">&quot;:wq&quot;</span>保存</span></span><br></pre></td></tr></table></figure>\n\n<h3>13.本地测试</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -v BTMuli@服务器ip</span><br></pre></td></tr></table></figure>\n\n<h2>三、云服务器网站配置</h2>\n\n<h3>1.创建网站目录并且设置权限</h3>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su root</span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> /home/MyBlog</span><br><span class=\"line\"><span class=\"built_in\">chown</span> BTMuli:BTMuli -R /home/MyBlog</span><br></pre></td></tr></table></figure>\n\n<h3>2.安装Nginx</h3>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y nginx</span><br><span class=\"line\">systemctl start nginx.service    <span class=\"comment\">#启动服务</span></span><br></pre></td></tr></table></figure>\n\n<h3>3.修改Nginx配置文件</h3>\n\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">vim</span> /etc/nginx/nginx.conf </span><br><span class=\"line\"><span class=\"comment\"># 按&quot;i&quot;进入编辑模式，修改为如下代码：</span></span><br><span class=\"line\"> <span class=\"number\">38</span>     server &#123;</span><br><span class=\"line\"> 39         <span class=\"attribute\">listen</span>       <span class=\"number\">80</span> default_server;</span><br><span class=\"line\"> 40         <span class=\"attribute\">listen</span>       [::]:<span class=\"number\">80</span> default_server;</span><br><span class=\"line\"> 41         <span class=\"attribute\">server_name</span>  btmuli.site;        <span class=\"comment\">#域名</span></span><br><span class=\"line\"> 42         <span class=\"attribute\">root</span>         /home/MyBlog;        <span class=\"comment\">#网站目录</span></span><br></pre></td></tr></table></figure>\n\n<h3>4.重启服务器</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart nginx.service</span><br></pre></td></tr></table></figure>\n\n<h3>5.建立git仓库</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su root</span><br><span class=\"line\">cd /home/BTMuli</span><br><span class=\"line\">git init --bare blog.git</span><br><span class=\"line\">chown BTMuli:BTMuli -R blog.git</span><br></pre></td></tr></table></figure>\n\n<h3>6.同步网站根目录</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim blog.git/hooks/post-receive</span><br><span class=\"line\"><span class=\"meta\"># </span><span class=\"language-bash\">按<span class=\"string\">&quot;i&quot;</span>进入编辑模式，把sshkey粘贴进来</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"language-bash\">!/bin/sh</span></span><br><span class=\"line\">git --work-tree=/home/MyBlog --git-dir=/home/BTMuli/blog.git checkout -f</span><br></pre></td></tr></table></figure>\n\n<h3>7.修改权限</h3>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /home/BTMuli/blog.git/hooks/post-receive</span><br></pre></td></tr></table></figure>\n\n<h3>8.在windows10本地hexo目录修改_config.yml文件</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repository: </span><br><span class=\"line\">  \t- https://github.com/BTMuli/BTMuli.github.io</span><br><span class=\"line\">  \t- BTMuli@81.71.129.119:/home/BTMuli/blog.git    #用户名@服务器Ip:git仓库位置</span><br><span class=\"line\">  branch: main</span><br></pre></td></tr></table></figure>\n\n<h3>9.在本机gitbash部署</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g -d</span><br></pre></td></tr></table></figure>\n\n<h2>四、常见报错</h2>\n\n<h3>1. <code>git-upload-pack</code>: 未找到命令</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash: git-upload-pack: command not found</span><br><span class=\"line\">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ln -s  /usr/local/git/bin/git-upload-pack  /usr/bin/git-upload-pack</span><br></pre></td></tr></table></figure>\n\n<h3> 2.<code>git-receive-pack</code>: 未找到命令</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash: git-receive-pack: command not found</span><br><span class=\"line\">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ln -s /usr/local/git/bin/git-receive-pack  /usr/bin/git-receive-pack</span><br></pre></td></tr></table></figure>\n\n<h3>3.无法远程连接获取</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">重试或者 删掉本地ssh公钥重新上传至服务器</span><br></pre></td></tr></table></figure>\n\n<h3>4.key出错</h3>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Host key verification failed.</span><br></pre></td></tr></table></figure>\n\n<p>解决方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -R 你要访问的IP地址</span><br></pre></td></tr></table></figure>\n\n<p>参考文章：</p>\n<ul>\n<li><a href=\"http://fuchenchenle.cn/2020/08/18/hexo%E9%83%A8%E7%BD%B2%E8%85%BE%E8%AE%AF%E4%BA%91/\">Hexo部署到腾讯云</a></li>\n</ul>\n","categories":[{"name":"帮助文档","path":"api/categories/帮助文档.json"}],"tags":[{"name":"hexo","path":"api/tags/hexo.json"},{"name":"腾讯云","path":"api/tags/腾讯云.json"}]}